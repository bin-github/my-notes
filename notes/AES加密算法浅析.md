#### Aes加密算法浅析

##### 1、概述：
>> 1、aes是对称加密算法，

>> 2、主要组成部分：秘钥、填充、模式
![image](http://note.youdao.com/yws/api/personal/file/DC14866C6C6F4F02AEE09651242D892D?method=download&shareKey=77bc290e88a89ca304f03148515013bb)

>> 3、分类：

AES	| 密钥长度（32位比特字)	| 分组长度(32位比特字)	|	加密轮数|扩展秘钥长度（行 * 列 * 数量）
---|---|---|---|---
AES-128 | 4	| 	4	| 	10|4 * 4 *（10 + 1）
AES-192 | 6	| 	4	| 	12|6 * 4 *（12 + 1）
AES-256 | 8	| 	4	| 	14|8 * 4 *（14 + 1）
##### 2、过程
> 1、把明文按照128bit拆分成若干个明文块（不论是128、192、256明文块都是128bit）是分块加密。
>> 1、是将所有内容都拆成128位的明文块？    
>> 2、如果最后不足一个128bit块的，使用指定的填充方式进行填充，  
>> 3、如果刚好是128bit的整数倍，除NoPadding填充方式之外，别的填充法需要新增一个随机的128bit块，和全量明文已经分好的块一起组成最终的明文块集

> 2、按照选择的填充方式来填充最后一个明文块。

> 3、每一个明文块利用AES加密器和密钥，加密成密文块。

> 4、拼接所有的密文块，成为最终的密文结果。

##### 3、加密原理：
> 1、从明文块到密文块的过程：
```
graph LR
明文块-->密文块
```
>> 1、初始轮：只有加轮秘钥一个操作、只有1次

>> 2、普通轮：包含所有的四个操作 ，有N次，根据秘钥的长度而定，（128:10 -1,192:12-1,256:14-1，减的一是最终轮的一次）

>> 3、最终轮：字节代替、行移位、加轮秘钥三个操作，只有1次

> 2、每轮的具体操作：

>> 前提：16字节的明文块在每一个处理步骤中都被排列成4X4的二维数组。

>> 1、字节代替(SubBytes)：把明文块的每一个字节都替代成一个称为S盒的常量二维数组中对应的另外一个字节(使用了矩阵中替换和逆矩阵，为了解密)。

>> 2、行移位(ShiftRows)：每个明文块都是4*4的二维数组，每行循环左移N字节，N = 没行行下标（0,1,2,3）

>> 3、列混淆(MixColumns)：每一列要和一个名为修补矩阵（fixedmatrix）的二维常量数组做矩阵相乘，得到对应的输出列。

>> 4、加轮秘钥(AddRoundKey)：这一步是唯一利用到密钥的一步，让输入数组的每一个字节a[i,j]与密钥对应位置的字节k[i,j]异或一次，就生成了输出值b[i,j]。每一轮的加密秘钥都是不相同的，只有初始轮的秘钥是原始秘钥，之后的每一轮秘钥都是经过扩展的秘钥。   
>> **扩展秘钥**：AES源代码中用长度4 * 4 *（10+1）字节的数组W来存储所有轮的密钥。W{0-15}的值等同于原始密钥的值，用于为初始轮做处理。后续每一个元素W[i]都是由W[i-4]和W[i-1]计算而来，直到数组W的所有元素都赋值完成。　

>> **扩展：在192bit或者256bit的加密中，保存扩展秘钥的二维数组列数是不变的，扩展数组 W{}的初始大小为 6行 * 4列、8行 * 4列**

>>**？**　*在192、256位加密中，扩展的秘钥W{}的大小是否是6 * 4 * (12 + 1)和8 * 4 * (14 + 1)*。

整体流程图：
![image](http://note.youdao.com/yws/api/personal/file/B4061389259E4E9B88BFB7FB51670715?method=download&shareKey=6721ca582d31f6d664245dd01da6676e)
